import{$ as Ne,A as we,Aa as B,B as pe,C as xe,D as Me,E as w,F as x,G as Se,H as M,I as S,J as Oe,K as R,L as A,M as c,N as a,O as Y,P as C,Q as m,R as h,S as Pe,T as ke,U as De,V as d,W as L,X as Ee,Y as O,Z as P,_ as k,a as fe,c as q,ca as Fe,d as ee,da as me,e as G,ea as te,f as F,fa as Te,g as de,ga as Ie,h as T,ha as Re,i as J,j as I,k as ge,ka as v,l as Q,la as Ae,m as he,ma as Le,n as le,na as ze,o as y,oa as Ve,p as ve,pa as je,q as f,qa as We,r as g,ra as Ue,s as be,sa as Be,t as _e,ta as Ke,u as _,ua as He,v as Ce,va as z,w as l,wa as V,x as b,xa as j,y as u,ya as W,z as ye,za as U}from"./chunk-RVZSYVYV.js";var K=class i{normalize(t){return t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")}calculateScore(t,e){if(t=this.normalize(t),e=this.normalize(e),e===t)return 1;if(e.startsWith(t))return .9;let o=0,n=0,r=-1,s=0;for(let p=0;p<e.length&&s<t.length;p++)e[p]===t[s]&&(o+=.1,r===p-1?(n++,o+=n*.05):n=0,(p===0||e[p-1]===" ")&&(o+=.2),r=p,s++);return s<t.length&&(o-=(t.length-s)*.1),Math.max(0,Math.min(1,o))}search(t,e,o={}){let{threshold:n=.3,limit:r=10}=o;return t?e.map(p=>({item:p,score:this.calculateScore(t,p)})).filter(p=>p.score>=n).sort((p,E)=>E.score-p.score).slice(0,r).map(p=>p.item):[]}static \u0275fac=function(e){return new(e||i)};static \u0275prov=Q({token:i,factory:i.\u0275fac,providedIn:"root"})};var et=()=>[import("./chunk-DDNODEQ2.js").then(i=>i.FoodCardComponent)],tt=(i,t)=>t.id;function ot(i,t){if(i&1&&(c(0,"div",3),d(1),a()),i&2){let e=h();l(),L(e.foods.error())}}function nt(i,t){i&1&&(c(0,"div",4),d(1,"Loading foods..."),a())}function it(i,t){if(i&1&&Y(0,"app-food-card",7),i&2){let e=t.$implicit;w("food",e)}}function rt(i,t){if(i&1&&(c(0,"div",5),R(1,it,1,1,"app-food-card",7,tt),a()),i&2){let e=h(2);l(),A(e.displayedFoods())}}function at(i,t){i&1&&(c(0,"div",6),d(1,"No foods found matching your search."),a())}function st(i,t){if(i&1&&M(0,rt,3,0,"div",5)(1,at,2,0,"div",6),i&2){let e=h();S(e.filteredFoods().length>0?0:1)}}var oe=class i{storage=y(B);fuzzySearch=y(K);searchTerm=_("");foods=this.storage.foods;filteredFoods=me(()=>{let t=this.searchTerm(),e=this.foods.value();if(!t)return e.sort((r,s)=>s.dateUpdated.getTime()-r.dateUpdated.getTime());let o=e.map(r=>r.name),n=this.fuzzySearch.search(t,o,{threshold:.3});return e.filter(r=>n.includes(r.name)).sort((r,s)=>s.dateUpdated.getTime()-r.dateUpdated.getTime())});displayedFoods=me(()=>this.filteredFoods().slice(0,30));onSearch(t){this.searchTerm.set(t)}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=u({type:i,selectors:[["app-food-list"]],decls:8,vars:4,consts:[[1,"food-list-container"],[1,"search-container"],["type","text","placeholder","Search",1,"search-input",3,"ngModelChange","ngModel","disabled"],[1,"error-message"],[1,"loading-message"],[1,"food-list"],[1,"no-foods-message"],[3,"food"]],template:function(e,o){e&1&&(c(0,"div",0)(1,"div",1)(2,"input",2),m("ngModelChange",function(r){return o.onSearch(r)}),a()(),M(3,ot,2,1,"div",3),M(4,nt,2,0,"div",4),ye(5,st,2,1),xe(6,5,et),Me(),a()),e&2&&(l(2),w("ngModel",o.searchTerm())("disabled",o.foods.isLoading()),l(),S(o.foods.error()?3:-1),l(),S(o.foods.isLoading()?4:-1))},dependencies:[v,W,z,V,j],styles:[".food-list-container[_ngcontent-%COMP%]{padding:1rem}.search-container[_ngcontent-%COMP%]{position:sticky;top:0;z-index:10;background:var(--bg-primary);padding:.5rem;margin:-.5rem -.5rem 1rem;box-shadow:0 2px 4px #0000001a}.search-input[_ngcontent-%COMP%]{width:100%;padding:1rem;border:2px solid var(--input-border);border-radius:8px;transition:all .2s ease;appearance:none;background-color:var(--input-bg);color:var(--text-primary)}.search-input[_ngcontent-%COMP%]:disabled{background-color:var(--bg-secondary);cursor:not-allowed}.search-input[_ngcontent-%COMP%]:focus{border-color:var(--text-accent);outline:none;box-shadow:0 0 0 3px #007bff40}@media (hover: none){.search-input[_ngcontent-%COMP%]{font-size:16px}}.food-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;width:100%}.loading-message[_ngcontent-%COMP%], .no-foods-message[_ngcontent-%COMP%]{text-align:center;padding:clamp(1rem,4vw,2rem);color:var(--text-secondary);font-size:clamp(.875rem,2.5vw,1rem)}"]})};function dt(i,t){if(i&1){let e=C();c(0,"button",9),m("click",function(){f(e);let n=h();return g(n.clearData())}),d(1,"Click again to confirm"),a()}}function lt(i,t){if(i&1){let e=C();c(0,"button",9),m("click",function(){f(e);let n=h();return g(n.confirmClear())}),d(1,"Clear All Data"),a()}}var ne=class i{constructor(t,e){this.storage=t;this.notificationService=e}isConfirming=_(!1);clearDataTimeout=null;ngOnDestroy(){this.clearDataTimeout&&(clearTimeout(this.clearDataTimeout),this.clearDataTimeout=null)}async exportData(){try{let t=await this.storage.exportData(),e=new Blob([t],{type:"application/json"}),o=window.URL.createObjectURL(e),n=document.createElement("a"),r=new Date().toISOString().split("T")[0];n.href=o,n.download=`histaminer-export-${r}.json`,document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(o)}catch(t){throw console.error("Export failed:",t),t}}handleImport(t){let e=t.target,o=e?.files?.[0];if(!o)return;let n=new FileReader;n.onload=async r=>{try{let s=JSON.parse(r.target?.result);this.isValidExportFile(s)?(await this.storage.importData(s.data),this.notificationService.show("Data imported successfully","success"),e.value=""):(this.notificationService.show("Invalid import file format","error"),e.value="")}catch{this.notificationService.show("Error reading import file","error"),e.value=""}},n.readAsText(o)}confirmClear(){this.isConfirming.set(!0)}async clearData(){try{await this.storage.clearAllData(),this.notificationService.show("All data has been cleared","success",3e3),this.isConfirming.set(!1)}catch(t){this.notificationService.show(`Error clearing data: ${t.message}`,"error")}finally{this.isConfirming.set(!1)}}isValidExportFile(t){return t&&t.metadata&&t.data&&Array.isArray(t.data.foods)&&t.data.foods.every(e=>e.id&&e.name&&Array.isArray(e.interactions))}static \u0275fac=function(e){return new(e||i)(b(B),b(U))};static \u0275cmp=u({type:i,selectors:[["app-settings"]],decls:26,vars:1,consts:[["fileInput",""],[1,"settings-container"],[1,"settings-section"],[1,"settings-actions"],[1,"action-card"],[1,"btn","btn-primary",3,"click"],["type","file","accept",".json",1,"file-input",3,"change"],[1,"action-card","danger-zone"],[1,"btn","btn-danger"],[1,"btn","btn-danger",3,"click"]],template:function(e,o){if(e&1){let n=C();c(0,"div",1)(1,"section",2)(2,"div",3)(3,"div",4)(4,"h4"),d(5,"Export Data"),a(),c(6,"p"),d(7,"Download all your food and reaction data as a JSON file"),a(),c(8,"button",5),m("click",function(){return f(n),g(o.exportData())}),d(9," Export Data "),a()(),c(10,"div",4)(11,"h4"),d(12,"Import Data"),a(),c(13,"p"),d(14,"Import previously exported data from a JSON file"),a(),c(15,"input",6,0),m("change",function(s){return f(n),g(o.handleImport(s))}),a(),c(17,"button",5),m("click",function(){f(n);let s=De(16);return g(s.click())}),d(18," Import Data "),a()(),c(19,"div",7)(20,"h4"),d(21,"Clear All Data"),a(),c(22,"p"),d(23,"Remove all stored foods and reactions. This action cannot be undone!"),a(),M(24,dt,2,0,"button",8)(25,lt,2,0,"button",8),a()()()()}e&2&&(l(24),S(o.isConfirming()?24:25))},dependencies:[v],styles:[".settings-container[_ngcontent-%COMP%]{padding:clamp(1rem,3vw,2rem);max-width:min(100%,800px);margin:0 auto}h2[_ngcontent-%COMP%]{font-size:clamp(1.5rem,4vw,2rem);margin-bottom:2rem;color:var(--text-primary)}h3[_ngcontent-%COMP%]{font-size:clamp(1.25rem,3vw,1.5rem);color:var(--text-secondary);margin-bottom:1rem}.settings-section[_ngcontent-%COMP%]{background:var(--card-bg);border-radius:8px;padding:clamp(1rem,3vw,2rem);box-shadow:0 2px 4px #0000001a}.settings-actions[_ngcontent-%COMP%]{display:grid;gap:1.5rem}.action-card[_ngcontent-%COMP%]{padding:1.5rem;border:1px solid var(--border-color);border-radius:8px;background:var(--bg-secondary)}.action-card[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:clamp(1rem,2.5vw,1.25rem);margin:0 0 .5rem;color:var(--text-primary)}.action-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--text-secondary);margin-bottom:1rem;font-size:clamp(.875rem,2vw,1rem)}.danger-zone[_ngcontent-%COMP%]{border-color:#dc3545}.file-input[_ngcontent-%COMP%]{display:none}@media (min-width: 768px){.settings-actions[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(300px,1fr))}}"]})};var pt=["autoInput"];function mt(i,t){if(i&1){let e=C();c(0,"div",5),m("click",function(){let n=f(e).$implicit,r=h(2);return g(r.onClick(n))}),c(1,"strong"),d(2),a(),d(3),a()}if(i&2){let e=t.$implicit,o=t.$index,n=h(2);x("autocomplete-active",o===n.currentFocus),l(2),L(e.substring(0,n.foodName().length)),l(),Ee(" ",e.substring(n.foodName().length)," ")}}function ut(i,t){if(i&1&&(c(0,"div",3),R(1,mt,4,4,"div",4,Oe),a()),i&2){let e=h();l(),A(e.filteredSuggestions)}}var ie=class i{constructor(t){this.fuzzySearch=t}suggestions=te([]);inputElement=Te("autoInput");foodName=Ie("");currentFocus=-1;showSuggestions=!1;filteredSuggestions=[];onInput(){if(this.showSuggestions=!0,this.currentFocus=-1,!this.foodName()){this.filteredSuggestions=[];return}this.filteredSuggestions=this.fuzzySearch.search(this.foodName(),this.suggestions(),{threshold:.3,limit:10})}onClick(t){this.foodName.set(t),this.showSuggestions=!1}onKeyDown(t){this.showSuggestions&&(t.key==="ArrowDown"?(this.currentFocus++,this.currentFocus>=this.filteredSuggestions.length&&(this.currentFocus=0)):t.key==="ArrowUp"?(this.currentFocus--,this.currentFocus<0&&(this.currentFocus=this.filteredSuggestions.length-1)):t.key==="Enter"&&(t.preventDefault(),this.currentFocus>-1&&this.onClick(this.filteredSuggestions[this.currentFocus])))}static \u0275fac=function(e){return new(e||i)(b(K))};static \u0275cmp=u({type:i,selectors:[["app-food-autocomplete"]],viewQuery:function(e,o){e&1&&Pe(o.inputElement,pt,5),e&2&&ke()},inputs:{suggestions:[1,"suggestions"],foodName:[1,"foodName"]},outputs:{foodName:"foodNameChange"},decls:4,vars:2,consts:[["autoInput",""],[1,"autocomplete"],["type","text","placeholder","Search",3,"ngModelChange","input","keydown","ngModel"],[1,"autocomplete-items"],[3,"autocomplete-active"],[3,"click"]],template:function(e,o){if(e&1){let n=C();c(0,"div",1)(1,"input",2,0),k("ngModelChange",function(s){return f(n),P(o.foodName,s)||(o.foodName=s),g(s)}),m("input",function(){return f(n),g(o.onInput())})("keydown",function(s){return f(n),g(o.onKeyDown(s))}),a(),M(3,ut,3,0,"div",3),a()}e&2&&(l(),O("ngModel",o.foodName),l(2),S(o.showSuggestions?3:-1))},dependencies:[v,W,z,V,j],styles:[".autocomplete[_ngcontent-%COMP%]{position:relative;display:inline-block;width:100%}.autocomplete[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:1rem;font-size:1rem;border:2px solid var(--input-border);border-radius:8px;background-color:var(--input-bg);color:var(--text-primary);transition:border-color .2s ease;appearance:none}.autocomplete[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--text-accent)}.autocomplete-items[_ngcontent-%COMP%]{position:absolute;border:1px solid var(--border-color);border-radius:0 0 4px 4px;border-top:none;z-index:99;top:100%;left:0;right:0;max-height:250px;overflow-y:auto;background-color:var(--bg-primary);box-shadow:0 2px 4px #0000001a}.autocomplete-items[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{padding:10px;cursor:pointer;color:var(--text-primary);transition:background-color .2s ease}.autocomplete-items[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:hover{background-color:var(--hover-bg)}.autocomplete-active[_ngcontent-%COMP%]{background-color:var(--hover-bg)!important;color:var(--text-primary)!important}"]})};var re=class i{constructor(t,e,o){this.storage=t;this.router=e;this.notificationService=o;this.foodNames=this.storage.foodNames}food=te();foodName=_("");notes=_("");isNoReaction=_(!0);isImmediateReaction=_(!1);isDelayedReaction=_(!1);foodNames;ngOnInit(){let t=this.food();t?.trim()&&this.foodName.set(t)}onNoReactionClick(){this.isNoReaction()&&(this.isImmediateReaction.set(!1),this.isDelayedReaction.set(!1))}onReactionTypeClick(){this.isImmediateReaction()||this.isDelayedReaction()?this.isNoReaction.set(!1):this.isNoReaction.set(!0)}hasAnyReactions(){return this.isImmediateReaction()||this.isDelayedReaction()}async saveFood(){if(!this.foodName().trim()){this.notificationService.show("Food name is required","error");return}let t={id:crypto.randomUUID(),date:new Date,reacted:this.hasAnyReactions(),isImmediateReaction:this.isImmediateReaction(),isDelayedReaction:this.isDelayedReaction(),notes:this.hasAnyReactions()?this.notes().trim():void 0};try{let e=this.storage.foods.value().find(o=>o.name.toLowerCase()===this.foodName().trim().toLowerCase());if(e)e.interactions.push(t),e.dateUpdated=new Date,await this.storage.updateFood(e),this.notificationService.show("Interaction added to existing food","success");else{let o={id:crypto.randomUUID(),name:this.foodName(),dateAdded:new Date,dateUpdated:new Date,interactions:[t]};await this.storage.addFood(o),this.notificationService.show("New food added successfully","success")}this.router.navigate(["/foods"])}catch(e){this.notificationService.show("Error saving food: "+e.message,"error")}}static \u0275fac=function(e){return new(e||i)(b(B),b(ze),b(U))};static \u0275cmp=u({type:i,selectors:[["app-add-food"]],inputs:{food:[1,"food"]},decls:19,vars:13,consts:[[1,"add-food-container"],[3,"foodNameChange","suggestions","foodName"],[1,"reaction-options"],[1,"reaction-button","no-reaction"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"reaction-button","immediate"],[1,"reaction-button","delayed"],[1,"notes-container"],["id","reaction-notes","placeholder","Notes...","rows","3",3,"ngModelChange","ngModel"],["type","submit",1,"btn","btn-success",3,"click","disabled"]],template:function(e,o){e&1&&(c(0,"div",0)(1,"app-food-autocomplete",1),k("foodNameChange",function(r){return P(o.foodName,r)||(o.foodName=r),r}),a(),c(2,"div",2)(3,"label",3)(4,"input",4),k("ngModelChange",function(r){return P(o.isNoReaction,r)||(o.isNoReaction=r),r}),m("ngModelChange",function(){return o.onNoReactionClick()}),a(),c(5,"span"),d(6,"\u{1F7E2} No Reaction"),a()(),c(7,"label",5)(8,"input",4),k("ngModelChange",function(r){return P(o.isImmediateReaction,r)||(o.isImmediateReaction=r),r}),m("ngModelChange",function(){return o.onReactionTypeClick()}),a(),c(9,"span"),d(10,"\u{1F534} Immediate Reaction"),a()(),c(11,"label",6)(12,"input",4),k("ngModelChange",function(r){return P(o.isDelayedReaction,r)||(o.isDelayedReaction=r),r}),m("ngModelChange",function(){return o.onReactionTypeClick()}),a(),c(13,"span"),d(14,"\u23F0 Delayed Reaction"),a()()(),c(15,"div",7)(16,"textarea",8),k("ngModelChange",function(r){return P(o.notes,r)||(o.notes=r),r}),a()(),c(17,"button",9),m("click",function(){return o.saveFood()}),d(18,"Save Food Entry"),a()()),e&2&&(l(),w("suggestions",o.foodNames()),O("foodName",o.foodName),l(2),x("active",o.isNoReaction()),l(),O("ngModel",o.isNoReaction),l(3),x("active",o.isImmediateReaction()),l(),O("ngModel",o.isImmediateReaction),l(3),x("active",o.isDelayedReaction()),l(),O("ngModel",o.isDelayedReaction),l(4),O("ngModel",o.notes),l(),w("disabled",!o.foodName().trim()))},dependencies:[v,W,z,He,V,j,ie],styles:['.add-food-container[_ngcontent-%COMP%]{padding:1rem;display:flex;flex-direction:column;gap:1rem}.food-name-input[_ngcontent-%COMP%]{width:100%;padding:1rem;font-size:1.2rem;border:2px solid var(--input-border);border-radius:12px;transition:border-color .3s;background:var(--input-bg);color:var(--text-primary)}.food-name-input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--text-accent)}.reaction-options[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;gap:1rem;margin-bottom:1rem}.reaction-button[_ngcontent-%COMP%]{flex:1;position:relative;display:flex;justify-content:center;align-items:center;padding:1rem;border:2px solid var(--input-border);border-radius:12px;background:var(--card-bg);cursor:pointer;transition:all .2s ease}.reaction-button[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{position:absolute;opacity:0;width:0;height:0}.reaction-button[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:1.1rem;white-space:nowrap}.reaction-button[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 2px 4px #0000001a}.reaction-button.active[_ngcontent-%COMP%]{border-color:var(--text-accent);background:var(--input-bg);box-shadow:0 2px 4px #0003}.reaction-button.no-reaction.active[_ngcontent-%COMP%]{border-color:#51cf66;color:#51cf66}.reaction-button.immediate.active[_ngcontent-%COMP%]{border-color:#fd7e14;color:#fd7e14}.reaction-button.delayed.active[_ngcontent-%COMP%]{border-color:#ffd43b;color:#ffd43b}.reaction-button.both.active[_ngcontent-%COMP%]{border-color:#fa5252;color:#fa5252}.select-multiple-hint[_ngcontent-%COMP%]{color:var(--text-secondary);font-size:.9rem;margin:0 0 .5rem;text-align:center;font-style:italic}.reaction-type-label[_ngcontent-%COMP%]{position:relative;padding:1rem;border:2px solid var(--input-border);background:var(--card-bg);border-radius:12px;font-size:1rem;cursor:pointer;transition:all .3s;display:flex;align-items:center;gap:.75rem;color:var(--text-primary)}.reaction-type-label[_ngcontent-%COMP%]:hover{border-color:var(--text-accent)}.reaction-type-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{opacity:0;position:absolute}.checkbox-custom[_ngcontent-%COMP%]{width:24px;height:24px;border:2px solid var(--input-border);border-radius:6px;display:inline-block;position:relative;transition:all .3s}.checkbox-custom[_ngcontent-%COMP%]:after{content:"";position:absolute;display:none;left:7px;top:3px;width:6px;height:12px;border:solid white;border-width:0 2px 2px 0;transform:rotate(45deg)}.reaction-type-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + .checkbox-custom[_ngcontent-%COMP%]{background-color:var(--text-accent);border-color:var(--text-accent)}.reaction-type-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + .checkbox-custom[_ngcontent-%COMP%]:after{display:block}.reaction-type-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked ~ span[_ngcontent-%COMP%]:last-child{color:var(--text-accent)}.reaction-types[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:1rem;border:2px solid var(--input-border);background:var(--card-bg);border-radius:12px;font-size:1rem;cursor:pointer;transition:all .3s;color:var(--text-primary)}.reaction-types[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:var(--text-accent);color:#fff;border-color:var(--text-accent)}.notes-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.notes-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;color:var(--text-primary)}.notes-container[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;padding:.75rem;border:2px solid var(--input-border);border-radius:8px;background:var(--input-bg);color:var(--text-primary);resize:vertical;min-height:80px;font-family:inherit;transition:border-color .3s}.notes-container[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--text-accent)}@media (min-width: 768px){.reaction-types[_ngcontent-%COMP%]{flex-direction:row}.reaction-type-label[_ngcontent-%COMP%]{flex:1}}']})};var Je=[{path:"",redirectTo:"foods",pathMatch:"full"},{path:"foods",component:oe},{path:"foods/add",component:re},{path:"settings",component:ne}];var ue="Service workers are disabled or not supported by this browser",Z=class{serviceWorker;worker;registration;events;constructor(t,e){if(this.serviceWorker=t,!t)this.worker=this.events=this.registration=new q(o=>o.error(new I(5601,!1)));else{let o=null,n=new ee;this.worker=new q(N=>(o!==null&&N.next(o),n.subscribe($=>N.next($))));let r=()=>{let{controller:N}=t;N!==null&&(o=N,n.next(o))};t.addEventListener("controllerchange",r),r(),this.registration=this.worker.pipe(J(()=>t.getRegistration()));let s=new ee;this.events=s.asObservable();let p=N=>{let{data:$}=N;$?.type&&s.next($)};t.addEventListener("message",p),e?.get(pe,null,{optional:!0})?.onDestroy(()=>{t.removeEventListener("controllerchange",r),t.removeEventListener("message",p)})}}postMessage(t,e){return new Promise(o=>{this.worker.pipe(T(1)).subscribe(n=>{n.postMessage(fe({action:t},e)),o()})})}postMessageWithOperation(t,e,o){let n=this.waitForOperationCompleted(o),r=this.postMessage(t,e);return Promise.all([r,n]).then(([,s])=>s)}generateNonce(){return Math.round(Math.random()*1e7)}eventsOfType(t){let e;return typeof t=="string"?e=o=>o.type===t:e=o=>t.includes(o.type),this.events.pipe(de(e))}nextEventOfType(t){return this.eventsOfType(t).pipe(T(1))}waitForOperationCompleted(t){return new Promise((e,o)=>{this.eventsOfType("OPERATION_COMPLETED").pipe(de(n=>n.nonce===t),T(1),G(n=>{if(n.result!==void 0)return n.result;throw new Error(n.error)})).subscribe({next:e,error:o})})}get isEnabled(){return!!this.serviceWorker}},gt=(()=>{class i{sw;messages;notificationClicks;subscription;get isEnabled(){return this.sw.isEnabled}pushManager=null;subscriptionChanges=new ee;constructor(e){if(this.sw=e,!e.isEnabled){this.messages=F,this.notificationClicks=F,this.subscription=F;return}this.messages=this.sw.eventsOfType("PUSH").pipe(G(n=>n.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(G(n=>n.data)),this.pushManager=this.sw.registration.pipe(G(n=>n.pushManager));let o=this.pushManager.pipe(J(n=>n.getSubscription()));this.subscription=new q(n=>{let r=o.subscribe(n),s=this.subscriptionChanges.subscribe(n);return()=>{r.unsubscribe(),s.unsubscribe()}})}requestSubscription(e){if(!this.sw.isEnabled||this.pushManager===null)return Promise.reject(new Error(ue));let o={userVisibleOnly:!0},n=this.decodeBase64(e.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),r=new Uint8Array(new ArrayBuffer(n.length));for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return o.applicationServerKey=r,new Promise((s,p)=>{this.pushManager.pipe(J(E=>E.subscribe(o)),T(1)).subscribe({next:E=>{this.subscriptionChanges.next(E),s(E)},error:p})})}unsubscribe(){if(!this.sw.isEnabled)return Promise.reject(new Error(ue));let e=o=>{if(o===null)throw new I(5602,!1);return o.unsubscribe().then(n=>{if(!n)throw new I(5603,!1);this.subscriptionChanges.next(null)})};return new Promise((o,n)=>{this.subscription.pipe(T(1),J(e)).subscribe({next:o,error:n})})}decodeBase64(e){return atob(e)}static \u0275fac=function(o){return new(o||i)(le(Z))};static \u0275prov=Q({token:i,factory:i.\u0275fac})}return i})(),ht=(()=>{class i{sw;versionUpdates;unrecoverable;get isEnabled(){return this.sw.isEnabled}constructor(e){if(this.sw=e,!e.isEnabled){this.versionUpdates=F,this.unrecoverable=F;return}this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(ue));let e=this.sw.generateNonce();return this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:e},e)}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new I(5601,!1));let e=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:e},e)}static \u0275fac=function(o){return new(o||i)(le(Z))};static \u0275prov=Q({token:i,factory:i.\u0275fac})}return i})();var Ye=new he("");function vt(){let i=y(X);if(!("serviceWorker"in navigator&&i.enabled!==!1))return;let t=y(Ye),e=y(Ce),o=y(pe);e.runOutsideAngular(()=>{let n=navigator.serviceWorker,r=()=>n.controller?.postMessage({action:"INITIALIZE"});n.addEventListener("controllerchange",r),o.onDestroy(()=>{n.removeEventListener("controllerchange",r)})}),e.runOutsideAngular(()=>{let n,{registrationStrategy:r}=i;if(typeof r=="function")n=new Promise(s=>r().subscribe(()=>s()));else{let[s,...p]=(r||"registerWhenStable:30000").split(":");switch(s){case"registerImmediately":n=Promise.resolve();break;case"registerWithDelay":n=Qe(+p[0]||0);break;case"registerWhenStable":n=Promise.race([o.whenStable(),Qe(+p[0])]);break;default:throw new I(5600,!1)}}n.then(()=>navigator.serviceWorker.register(t,{scope:i.scope}).catch(s=>console.error(ge(5604,!1))))})}function Qe(i){return new Promise(t=>setTimeout(t,i))}function bt(i,t){return new Z(i.enabled!==!1?navigator.serviceWorker:void 0,t)}var X=class{enabled;scope;registrationStrategy};function Xe(i,t={}){return ve([gt,ht,{provide:Ye,useValue:i},{provide:X,useValue:t},{provide:Z,useFactory:bt,deps:[X,be]},we(vt)])}var $e={providers:[_e(),Fe(),We(Je,Be(),Ue()),Xe("ngsw-worker.js",{enabled:!Re(),registrationStrategy:"registerWhenStable:30000"})]};var _t=()=>({exact:!0}),ae=class i{static \u0275fac=function(e){return new(e||i)};static \u0275cmp=u({type:i,selectors:[["app-navigation"]],decls:8,vars:2,consts:[[1,"nav-container"],[1,"nav-content"],["routerLink","/foods","routerLinkActive","active",3,"routerLinkActiveOptions"],["routerLink","/foods/add","routerLinkActive","active"],["routerLink","/settings","routerLinkActive","active"]],template:function(e,o){e&1&&(c(0,"nav",0)(1,"div",1)(2,"a",2),d(3," Food List "),a(),c(4,"a",3),d(5," Add Food "),a(),c(6,"a",4),d(7," Settings "),a()()()),e&2&&(l(2),w("routerLinkActiveOptions",Ne(1,_t)))},dependencies:[v,Ke,Ve,je],styles:[".nav-container[_ngcontent-%COMP%]{background-color:var(--bg-secondary);border-bottom:1px solid var(--border-color);padding:.5rem 1rem;position:sticky;top:0;z-index:1000}.nav-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:1rem}a[_ngcontent-%COMP%]{color:var(--text-secondary);text-decoration:none;padding:.5rem 1rem;border-radius:4px;transition:all .2s ease}a[_ngcontent-%COMP%]:hover{background-color:var(--hover-bg)}a.active[_ngcontent-%COMP%]{color:var(--text-accent);background-color:var(--hover-bg)}"]})};var Ct=(i,t)=>t.id;function yt(i,t){if(i&1){let e=C();c(0,"div",2)(1,"div",3),d(2),a(),c(3,"button",4),m("click",function(){let n=f(e).$implicit,r=h();return g(r.notificationService.close(n.id))}),d(4," \xD7 "),a()()}if(i&2){let e=t.$implicit;Se(e.type),x("removing",e.removing),l(2),L(e.message)}}var se=class i{constructor(t){this.notificationService=t}static \u0275fac=function(e){return new(e||i)(b(U))};static \u0275cmp=u({type:i,selectors:[["app-notification-toast"]],decls:3,vars:0,consts:[["aria-live","polite",1,"notification-container"],["role","alert",1,"notification-toast",3,"class","removing"],["role","alert",1,"notification-toast"],[1,"notification-content"],["aria-label","Close notification",1,"close-button",3,"click"]],template:function(e,o){e&1&&(c(0,"div",0),R(1,yt,5,5,"div",1,Ct),a()),e&2&&(l(),A(o.notificationService.notifications()))},dependencies:[v],styles:[".notification-container[_ngcontent-%COMP%]{position:fixed;top:1rem;right:1rem;z-index:9999;display:flex;flex-direction:column;gap:.5rem;pointer-events:none}.notification-toast[_ngcontent-%COMP%]{padding:1rem;border-radius:4px;box-shadow:0 4px 6px #0000001a;animation:_ngcontent-%COMP%_slideIn .3s ease-out forwards;min-width:250px;max-width:350px;opacity:1;pointer-events:auto;display:flex;align-items:flex-start;gap:.5rem}.notification-content[_ngcontent-%COMP%]{flex:1}.close-button[_ngcontent-%COMP%]{background:none;border:none;padding:0;margin:0;font-size:1.5rem;line-height:1;cursor:pointer;opacity:.6;transition:opacity .2s ease}.close-button[_ngcontent-%COMP%]:hover{opacity:1}.notification-toast.success[_ngcontent-%COMP%]{background-color:#d4edda;color:#155724;border-left:4px solid #28a745}.notification-toast.error[_ngcontent-%COMP%]{background-color:#f8d7da;color:#721c24;border-left:4px solid #dc3545}.notification-toast[_ngcontent-%COMP%]{--slide-transform: translateX(120%)}@media (max-width: 768px){.notification-container[_ngcontent-%COMP%]{top:auto;bottom:1rem;right:1rem;left:1rem}.notification-toast[_ngcontent-%COMP%]{width:100%;max-width:none;--slide-transform: translateY(120%)}}@keyframes _ngcontent-%COMP%_slideIn{0%{transform:var(--slide-transform);opacity:0}to{transform:translate(0);opacity:1}}.notification-toast.removing[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideOut .3s ease-in forwards}@keyframes _ngcontent-%COMP%_slideOut{0%{transform:translate(0);opacity:1}to{transform:var(--slide-transform);opacity:0}}"]})};var ce=class i{title="histaminer";static \u0275fac=function(e){return new(e||i)};static \u0275cmp=u({type:i,selectors:[["app-root"]],decls:4,vars:0,template:function(e,o){e&1&&(Y(0,"app-notification-toast")(1,"app-navigation"),c(2,"main"),Y(3,"router-outlet"),a())},dependencies:[Le,ae,se],encapsulation:2})};Ae(ce,$e).catch(i=>console.error(i));
